{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/dasein/dev/explore_new/django-nextjs-realtime/frontend/components/auth/login.tsx\";\nimport { useRouter } from \"next/router\";\nimport { useRef, useState, useEffect } from \"react\";\nimport Head from \"next/head\";\nimport styles from \"../../styles/login.module.scss\";\nimport CustomButton from \"../buttons/button\";\nimport { loginWithUsername } from \"../../service/auth\";\nimport { getCookie } from \"../../service/cookie\";\n\nconst Login = () => {\n  const router = useRouter();\n  const {\n    0: errors,\n    1: setErrors\n  } = useState({\n    email: \"\",\n    password: \"\"\n  });\n  const {\n    0: emailError,\n    1: setUserameError\n  } = useState(null);\n  const {\n    0: passwordError,\n    1: setPasswordError\n  } = useState(null);\n  const {\n    0: loginError,\n    1: setLoginError\n  } = useState(null);\n\n  const is_admin = () => {\n    const access_token = getCookie(\"access_token\");\n\n    if (access_token) {\n      router.push(\"/sensors\");\n    }\n  };\n\n  useEffect(() => {\n    is_admin();\n  }, []);\n  const formRef = useRef(null);\n\n  const formHandler = event => {\n    const {\n      name,\n      value\n    } = event.target;\n    let tempErrors = errors;\n\n    switch (name) {\n      case \"email\":\n        tempErrors.email = value.length < 4 ? \"Username is not valid\" : \"\";\n        setUserameError(tempErrors.email.length > 0 ? true : false);\n        break;\n\n      case \"password\":\n        tempErrors.password = value.length < 6 ? \"Password must be at least 6 characters\" : \"\";\n        setPasswordError(tempErrors.password.length > 0 ? true : false);\n        break;\n\n      default:\n        break;\n    }\n\n    setErrors(tempErrors);\n  };\n\n  const emailLogin = async event => {\n    event.preventDefault();\n    setLoginError(null);\n    const formData = new FormData(formRef.current);\n    let res = await loginWithUsername(formData.get(\"email\"), formData.get(\"password\"));\n\n    if (res.error) {\n      console.log(res.error);\n      setLoginError(res.error);\n    } else if (res.user) {\n      router.push(\"/sensors\");\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: [/*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"link\", {\n        rel: \"icon\",\n        href: \"/favicon.svg\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.login_card_container,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: styles.login_header,\n        children: \"Login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.form_container,\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          className: styles.login_form,\n          ref: formRef,\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: [\"Username/ Email\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.contact_form_error,\n              children: errors.email\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              name: \"email\",\n              type: \"email\",\n              className: passwordError ? styles.text_input_error : styles.text_input,\n              placeholder: \"john@example.com\",\n              onChange: formHandler\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: [\"Password\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.contact_form_error,\n              children: errors.password\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 95,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              name: \"password\",\n              type: \"password\",\n              className: passwordError ? styles.text_input_error : styles.text_input,\n              placeholder: \"password\",\n              onChange: formHandler\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CustomButton, {\n            fill: true,\n            clickAction: event => emailLogin(event),\n            disabled: emailError || passwordError || emailError === null || passwordError === null,\n            children: \"Login\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 13\n          }, this), loginError && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.auth_form_error,\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\" \", loginError, \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n};\n\nexport default Login;","map":{"version":3,"sources":["/home/dasein/dev/explore_new/django-nextjs-realtime/frontend/components/auth/login.tsx"],"names":["useRouter","useRef","useState","useEffect","Head","styles","CustomButton","loginWithUsername","getCookie","Login","router","errors","setErrors","email","password","emailError","setUserameError","passwordError","setPasswordError","loginError","setLoginError","is_admin","access_token","push","formRef","formHandler","event","name","value","target","tempErrors","length","emailLogin","preventDefault","formData","FormData","current","res","get","error","console","log","user","login_card_container","login_header","form_container","login_form","contact_form_error","text_input_error","text_input","auth_form_error"],"mappings":"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","sourcesContent":["import { useRouter } from \"next/router\";\nimport { useRef, useState, useEffect } from \"react\";\nimport Head from \"next/head\";\nimport Link from \"next/link\";\nimport styles from \"../../styles/login.module.scss\";\nimport CustomButton from \"../buttons/button\";\nimport { loginWithUsername } from \"../../service/auth\";\nimport { getCookie } from \"../../service/cookie\";\n\nconst Login: React.SFC<{}> = () => {\n  const router = useRouter();\n  const [errors, setErrors] = useState({ email: \"\", password: \"\" });\n  const [emailError, setUserameError] = useState(null);\n  const [passwordError, setPasswordError] = useState(null);\n  const [loginError, setLoginError] = useState(null);\n\n  const is_admin = () => {\n    const access_token = getCookie(\"access_token\");\n\n    if (access_token) {\n      router.push(\"/sensors\");\n    }\n  };\n\n  useEffect(() => {\n    is_admin();\n  }, []);\n\n  const formRef = useRef(null);\n  const formHandler = (event) => {\n    const { name, value } = event.target;\n    let tempErrors = errors;\n    switch (name) {\n      case \"email\":\n        tempErrors.email = value.length < 4 ? \"Username is not valid\" : \"\";\n        setUserameError(tempErrors.email.length > 0 ? true : false);\n        break;\n      case \"password\":\n        tempErrors.password =\n          value.length < 6 ? \"Password must be at least 6 characters\" : \"\";\n        setPasswordError(tempErrors.password.length > 0 ? true : false);\n        break;\n      default:\n        break;\n    }\n    setErrors(tempErrors);\n  };\n\n  const emailLogin = async (event) => {\n    event.preventDefault();\n    setLoginError(null);\n    const formData = new FormData(formRef.current) as any;\n    let res = await loginWithUsername(\n      formData.get(\"email\"),\n      formData.get(\"password\")\n    );\n    if (res.error) {\n      console.log(res.error);\n      setLoginError(res.error);\n    } else if (res.user) {\n      router.push(\"/sensors\");\n    }\n  };\n\n  return (\n    <div>\n      <Head>\n        <title>Login</title>\n        <link rel=\"icon\" href=\"/favicon.svg\" />\n      </Head>\n\n      <div className={styles.login_card_container}>\n        <h2 className={styles.login_header}>Login</h2>\n\n        <div className={styles.form_container}>\n          <form className={styles.login_form} ref={formRef}>\n            <label>\n              Username/ Email\n              <br />\n              <span className={styles.contact_form_error}>{errors.email}</span>\n              <input\n                name=\"email\"\n                type=\"email\"\n                className={\n                  passwordError ? styles.text_input_error : styles.text_input\n                }\n                placeholder=\"john@example.com\"\n                onChange={formHandler}\n              />\n            </label>\n\n            <label>\n              Password\n              <br />\n              <span className={styles.contact_form_error}>\n                {errors.password}\n              </span>\n              <input\n                name=\"password\"\n                type=\"password\"\n                className={\n                  passwordError ? styles.text_input_error : styles.text_input\n                }\n                placeholder=\"password\"\n                onChange={formHandler}\n              />\n            </label>\n\n            <CustomButton\n              fill={true}\n              clickAction={(event) => emailLogin(event)}\n              disabled={\n                emailError ||\n                passwordError ||\n                emailError === null ||\n                passwordError === null\n              }\n            >\n              Login\n            </CustomButton>\n\n            {loginError && (\n              <div className={styles.auth_form_error}>\n                <span> {loginError} </span>\n              </div>\n            )}\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}