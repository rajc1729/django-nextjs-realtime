{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/home/dasein/dev/explore_new/django-nextjs-realtime/frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/dasein/dev/explore_new/django-nextjs-realtime/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/home/dasein/dev/explore_new/django-nextjs-realtime/frontend/components/auth/login.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { useRouter } from \"next/router\";\nimport { useRef, useState, useEffect } from \"react\";\nimport Head from \"next/head\";\nimport styles from \"../../styles/login.module.scss\";\nimport CustomButton from \"../buttons/button\";\nimport { loginWithUsername } from \"../../service/auth\";\nimport { getCookie } from \"../../service/cookie\";\n\nvar Login = function Login() {\n  _s();\n\n  var router = useRouter();\n\n  var _useState = useState({\n    email: \"\",\n    password: \"\"\n  }),\n      errors = _useState[0],\n      setErrors = _useState[1];\n\n  var _useState2 = useState(null),\n      emailError = _useState2[0],\n      setUserameError = _useState2[1];\n\n  var _useState3 = useState(null),\n      passwordError = _useState3[0],\n      setPasswordError = _useState3[1];\n\n  var _useState4 = useState(null),\n      loginError = _useState4[0],\n      setLoginError = _useState4[1];\n\n  var is_admin = function is_admin() {\n    var access_token = getCookie(\"access_token\");\n\n    if (access_token) {\n      router.push(\"/sensors\");\n    }\n  };\n\n  useEffect(function () {\n    is_admin();\n  }, []);\n  var formRef = useRef(null);\n\n  var formHandler = function formHandler(event) {\n    var _event$target = event.target,\n        name = _event$target.name,\n        value = _event$target.value;\n    var tempErrors = errors;\n\n    switch (name) {\n      case \"email\":\n        tempErrors.email = value.length < 4 ? \"Username is not valid\" : \"\";\n        setUserameError(tempErrors.email.length > 0 ? true : false);\n        break;\n\n      case \"password\":\n        tempErrors.password = value.length < 6 ? \"Password must be at least 6 characters\" : \"\";\n        setPasswordError(tempErrors.password.length > 0 ? true : false);\n        break;\n\n      default:\n        break;\n    }\n\n    setErrors(tempErrors);\n  };\n\n  var emailLogin = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n      var formData, res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault();\n              setLoginError(null);\n              formData = new FormData(formRef.current);\n              _context.next = 5;\n              return loginWithUsername(formData.get(\"email\"), formData.get(\"password\"));\n\n            case 5:\n              res = _context.sent;\n\n              if (res.error) {\n                console.log(res.error);\n                setLoginError(res.error);\n              } else if (res.user) {\n                router.push(\"/sensors\");\n              }\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function emailLogin(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: [/*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"link\", {\n        rel: \"icon\",\n        href: \"/favicon.svg\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.login_card_container,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: styles.login_header,\n        children: \"Login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.form_container,\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          className: styles.login_form,\n          ref: formRef,\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: [\"Username/ Email\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.contact_form_error,\n              children: errors.email\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(\"input\", {\n              name: \"email\",\n              type: \"email\",\n              className: passwordError ? styles.text_input_error : styles.text_input,\n              placeholder: \"john@example.com\",\n              onChange: formHandler\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 15\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: [\"Password\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.contact_form_error,\n              children: errors.password\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 95,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(\"input\", {\n              name: \"password\",\n              type: \"password\",\n              className: passwordError ? styles.text_input_error : styles.text_input,\n              placeholder: \"password\",\n              onChange: formHandler\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 15\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(CustomButton, {\n            fill: true,\n            clickAction: function clickAction(event) {\n              return emailLogin(event);\n            },\n            disabled: emailError || passwordError || emailError === null || passwordError === null,\n            children: \"Login\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 13\n          }, _this), loginError && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.auth_form_error,\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\" \", loginError, \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 17\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 15\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Login, \"vwzDcRLYpiJ8F+H/jiIsvXxUN9U=\", false, function () {\n  return [useRouter];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/home/dasein/dev/explore_new/django-nextjs-realtime/frontend/components/auth/login.tsx"],"names":["useRouter","useRef","useState","useEffect","Head","styles","CustomButton","loginWithUsername","getCookie","Login","router","email","password","errors","setErrors","emailError","setUserameError","passwordError","setPasswordError","loginError","setLoginError","is_admin","access_token","push","formRef","formHandler","event","target","name","value","tempErrors","length","emailLogin","preventDefault","formData","FormData","current","get","res","error","console","log","user","login_card_container","login_header","form_container","login_form","contact_form_error","text_input_error","text_input","auth_form_error"],"mappings":"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","sourcesContent":["import { useRouter } from \"next/router\";\nimport { useRef, useState, useEffect } from \"react\";\nimport Head from \"next/head\";\nimport Link from \"next/link\";\nimport styles from \"../../styles/login.module.scss\";\nimport CustomButton from \"../buttons/button\";\nimport { loginWithUsername } from \"../../service/auth\";\nimport { getCookie } from \"../../service/cookie\";\n\nconst Login: React.SFC<{}> = () => {\n  const router = useRouter();\n  const [errors, setErrors] = useState({ email: \"\", password: \"\" });\n  const [emailError, setUserameError] = useState(null);\n  const [passwordError, setPasswordError] = useState(null);\n  const [loginError, setLoginError] = useState(null);\n\n  const is_admin = () => {\n    const access_token = getCookie(\"access_token\");\n\n    if (access_token) {\n      router.push(\"/sensors\");\n    }\n  };\n\n  useEffect(() => {\n    is_admin();\n  }, []);\n\n  const formRef = useRef(null);\n  const formHandler = (event) => {\n    const { name, value } = event.target;\n    let tempErrors = errors;\n    switch (name) {\n      case \"email\":\n        tempErrors.email = value.length < 4 ? \"Username is not valid\" : \"\";\n        setUserameError(tempErrors.email.length > 0 ? true : false);\n        break;\n      case \"password\":\n        tempErrors.password =\n          value.length < 6 ? \"Password must be at least 6 characters\" : \"\";\n        setPasswordError(tempErrors.password.length > 0 ? true : false);\n        break;\n      default:\n        break;\n    }\n    setErrors(tempErrors);\n  };\n\n  const emailLogin = async (event) => {\n    event.preventDefault();\n    setLoginError(null);\n    const formData = new FormData(formRef.current) as any;\n    let res = await loginWithUsername(\n      formData.get(\"email\"),\n      formData.get(\"password\")\n    );\n    if (res.error) {\n      console.log(res.error);\n      setLoginError(res.error);\n    } else if (res.user) {\n      router.push(\"/sensors\");\n    }\n  };\n\n  return (\n    <div>\n      <Head>\n        <title>Login</title>\n        <link rel=\"icon\" href=\"/favicon.svg\" />\n      </Head>\n\n      <div className={styles.login_card_container}>\n        <h2 className={styles.login_header}>Login</h2>\n\n        <div className={styles.form_container}>\n          <form className={styles.login_form} ref={formRef}>\n            <label>\n              Username/ Email\n              <br />\n              <span className={styles.contact_form_error}>{errors.email}</span>\n              <input\n                name=\"email\"\n                type=\"email\"\n                className={\n                  passwordError ? styles.text_input_error : styles.text_input\n                }\n                placeholder=\"john@example.com\"\n                onChange={formHandler}\n              />\n            </label>\n\n            <label>\n              Password\n              <br />\n              <span className={styles.contact_form_error}>\n                {errors.password}\n              </span>\n              <input\n                name=\"password\"\n                type=\"password\"\n                className={\n                  passwordError ? styles.text_input_error : styles.text_input\n                }\n                placeholder=\"password\"\n                onChange={formHandler}\n              />\n            </label>\n\n            <CustomButton\n              fill={true}\n              clickAction={(event) => emailLogin(event)}\n              disabled={\n                emailError ||\n                passwordError ||\n                emailError === null ||\n                passwordError === null\n              }\n            >\n              Login\n            </CustomButton>\n\n            {loginError && (\n              <div className={styles.auth_form_error}>\n                <span> {loginError} </span>\n              </div>\n            )}\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}